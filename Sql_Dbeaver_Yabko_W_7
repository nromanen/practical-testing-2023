SELECT 
    c.company_name,
    c.city,
    o.order_date,
    o.required_date,
    o.shipped_date
FROM 
    customers c
JOIN 
    orders o ON c.customer_id = o.customer_id
WHERE 
    o.order_date = (
        SELECT 
            MAX(order_date)
        FROM 
            orders
        WHERE 
            customer_id = c.customer_id
    )
ORDER BY 
    c.company_name ASC,
    o.order_date DESC,  
    o.shipped_date DESC;

